{"version":3,"sources":["main.js"],"names":["document","addEventListener","quiz","querySelector","quizFieldsWrapper","querySelectorAll","buttonNext","error","stepCount","forEach","wrapper","toggleFields","reset","checkFields","textFields","el","e","currentTarget","checked","i","arr","parentElement","classList","toggle","isShowed","remove","fields","value","stepActive","checkNothing","selectedValues","isValid","preventDefault","input","getAttribute","nextElementSibling","add","setTimeout","textContent","checkbox","insertAdjacentHTML","closest","setAttribute","data","name","push","fetch","method","body","then","response","console","log","catch"],"mappings":"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","file":"../main.min.js","sourcesContent":["/* Common */\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n\tconst quiz = document.querySelector(\".quiz\");\r\n\r\n\tif (quiz) {\r\n\t\tconst quizFieldsWrapper = quiz.querySelectorAll(\".quiz__fields\");\r\n\t\tconst buttonNext = quiz.querySelector(\".quiz__next\");\r\n\t\tconst error = quiz.querySelector(\".quiz__error\");\r\n\t\tlet stepCount = 1;\r\n\r\n\t\tquizFieldsWrapper.forEach((wrapper) => {\r\n\t\t\tconst toggleFields = wrapper.querySelectorAll(\".js-toggle-field .field__label\");\r\n\t\t\tconst reset = quiz.querySelector(\".js-reset-fields input\");\r\n\t\t\tconst checkFields = wrapper.querySelectorAll('.field:not(.js-reset-fields) input[type=\"checkbox\"]');\r\n\t\t\tconst textFields = wrapper.querySelectorAll('.field:not(.js-reset-fields) input[type=\"text\"]');\r\n\r\n\t\t\tcheckFields.forEach((el) => {\r\n\t\t\t\tel.addEventListener(\"change\", (e) => {\r\n\t\t\t\t\tif (e.currentTarget.checked) {\r\n\t\t\t\t\t\treset.checked = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\ttextFields.forEach((el) => {\r\n\t\t\t\tel.addEventListener(\"change\", (e) => {\r\n\t\t\t\t\tif (e.currentTarget.checked) {\r\n\t\t\t\t\t\treset.checked = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\ttoggleFields.forEach((el, i, arr) => {\r\n\t\t\t\tel.addEventListener(\"click\", (e) => {\r\n\t\t\t\t\te.currentTarget.parentElement.classList.toggle(\"active\");\r\n\r\n\t\t\t\t\tif (i > 1) {\r\n\t\t\t\t\t\tlet isShowed = false;\r\n\r\n\t\t\t\t\t\tif (!isShowed) {\r\n\t\t\t\t\t\t\tarr[i+1].parentElement.classList.remove(\"closed\");\r\n\t\t\t\t\t\t\tisShowed = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tif (reset) {\r\n\t\t\t\treset.addEventListener(\"change\", (e) => {\r\n\t\t\t\t\tconst fields = quiz.querySelectorAll(\".quiz__step--4 .field:not(.js-reset-fields) input\");\r\n\r\n\t\t\t\t\tif (e.currentTarget.checked) {\r\n\t\t\t\t\t\tfields.forEach((el) => {\r\n\t\t\t\t\t\t\tel.value = \"\";\r\n\t\t\t\t\t\t\tel.checked = false;\r\n\t\t\t\t\t\t\tel.parentElement.classList.remove(\"active\");\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tbuttonNext.addEventListener(\"click\", (e) => {\r\n\t\t\tconst stepActive = quiz.querySelector(\".quiz__step.open\");\r\n\t\t\tconst checkNothing = quiz.querySelectorAll(\".js-check-nothing\");\r\n\t\t\tconst selectedValues = quiz.querySelectorAll(\".quiz__step--3 .field:not(.js-reset-fields) input, .quiz__step--4 .field:not(.js-reset-fields) input\");\r\n\t\t\tlet isValid = false;\r\n\r\n\t\t\tif (stepCount < 12) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t}\r\n\r\n\t\t\tif (stepCount < 13) {\r\n\t\t\t\t/* Проверяем, заполнено ли хотя бы одно значение на каждом шаге, если нет - показываем ошибку, если все норм, пускаем дальше */\r\n\t\t\t\tif (stepCount > 2) {\r\n\t\t\t\t\tconst selectedValuesStep = quizFieldsWrapper[stepCount - 3].querySelectorAll(\".field input\");\r\n\r\n\t\t\t\t\tselectedValuesStep.forEach((input) => {\r\n\t\t\t\t\t\tif (input.checked || (input.getAttribute(\"type\") === \"text\" && input.value !== \"\") || stepCount < 3 || stepCount > 4) {\r\n\t\t\t\t\t\t\tisValid = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (isValid) {\r\n\t\t\t\t\t\tstepActive.classList.remove(\"open\");\r\n\t\t\t\t\t\tstepActive.nextElementSibling.classList.add(\"open\");\r\n\t\t\t\t\t\tstepCount++;\r\n\t\t\t\t\t\terror.classList.add(\"d-none\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\terror.classList.remove(\"d-none\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstepActive.classList.remove(\"open\");\r\n\t\t\t\t\tstepActive.nextElementSibling.classList.add(\"open\");\r\n\t\t\t\t\tstepCount++;\r\n\r\n\t\t\t\t\t/* Если есть скрытый заголовок, делаем ему анимированное появление */\r\n\t\t\t\t\tif (stepActive.nextElementSibling.querySelector(\".hidden\")) {\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tstepActive.nextElementSibling.querySelector(\".hidden\").classList.remove(\"hidden\");\r\n\t\t\t\t\t\t}, 100);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tswitch (stepCount) {\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tbuttonNext.textContent = \"Вперед\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tbuttonNext.textContent = \"Больше не знаю\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 4:\r\n\t\t\t\t\tbuttonNext.textContent = \"Вперед\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 5:\r\n\t\t\t\t\tselectedValues.forEach((input) => {\r\n\t\t\t\t\t\tif (input.checked || (input.getAttribute(\"type\") === \"text\" && input.value != \"\")) {\r\n\t\t\t\t\t\t\t/* Перед каждым последним чекбоксом вставляем выбранные на предыдущих шагах */\r\n\t\t\t\t\t\t\tcheckNothing.forEach((checkbox) => {\r\n\t\t\t\t\t\t\t\tcheckbox.insertAdjacentHTML(\"beforebegin\", `<label class=\"field field--checkbox\">\r\n\t\t\t\t\t\t\t\t\t<input class=\"field__input\" type=\"checkbox\" name=\"${checkbox.closest(\".quiz__step\").getAttribute(\"data-name\")}_${input.getAttribute(\"name\")}\" /><span class=\"field__label\">${input.value}</span><b></b>\r\n\t\t\t\t\t\t\t\t</label>`);\r\n\r\n\t\t\t\t\t\t\t\tcheckbox.querySelector(\"input\").addEventListener(\"change\", (e) => {\r\n\t\t\t\t\t\t\t\t\tconst fields = e.currentTarget.closest(\".quiz__step\").querySelectorAll(\".field:not(.js-check-nothing) input\");\r\n\t\r\n\t\t\t\t\t\t\t\t\tif (e.currentTarget.checked) {\r\n\t\t\t\t\t\t\t\t\t\tfields.forEach((el) => {\r\n\t\t\t\t\t\t\t\t\t\t\tel.value = \"\";\r\n\t\t\t\t\t\t\t\t\t\t\tel.checked = false;\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 12:\r\n\t\t\t\t\tbuttonNext.setAttribute(\"type\", \"submit\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 13:\r\n\t\t\t\t\tquiz.addEventListener(\"submit\", (e) => {\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\tconst fields = quiz.querySelectorAll(\".field input\");\r\n\t\t\t\t\t\tconst data = [];\r\n\r\n\t\t\t\t\t\tfields.forEach((el) => {\r\n\t\t\t\t\t\t\tconst name = el.getAttribute(\"name\");\r\n\t\t\t\t\t\t\tconst value = el.value;\r\n\t\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t\tif ((el.getAttribute(\"type\") === \"checkbox\" && el.checked) || (el.getAttribute(\"type\") === \"text\" && el.value!= \"\")) {\r\n\t\t\t\t\t\t\t\tdata.push([name, value]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tfetch(\"path-to-ajax\", {\r\n\t\t\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\t\t\tbody: data,\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.then((response) => {\r\n\t\t\t\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.catch((error) => {\r\n\t\t\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tbuttonNext.classList.add(\"d-none\");\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t/* Если есть скрытый заголовок, делаем ему анимированное появление */\r\n\t\t\t\t\tif (stepActive.nextElementSibling.querySelector(\".hidden\")) {\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tstepActive.nextElementSibling.querySelector(\".hidden\").classList.remove(\"hidden\");\r\n\t\t\t\t\t\t}, 100);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t/* На последнем сообщении скрываем форму после 3 секунд */\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tquiz.classList.add(\"d-none\");\r\n\t\t\t\t\t}, 3000);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n});"]}
document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".quiz");if(e){const t=e.querySelectorAll(".quiz__fields"),l=e.querySelector(".quiz__next"),n=e.querySelector(".quiz__error");let c=1;t.forEach(t=>{const l=t.querySelectorAll(".js-toggle-field .field__label"),n=e.querySelector(".js-reset-fields input"),c=t.querySelectorAll('.field:not(.js-reset-fields) input[type="checkbox"]'),r=t.querySelectorAll('.field:not(.js-reset-fields) input[type="text"]');c.forEach(e=>{e.addEventListener("change",e=>{e.currentTarget.checked&&(n.checked=!1)})}),r.forEach(e=>{e.addEventListener("change",e=>{e.currentTarget.checked&&(n.checked=!1)})}),l.forEach((e,t,l)=>{e.addEventListener("click",e=>{if(e.currentTarget.parentElement.classList.toggle("active"),t>1){let e=!1;e||(l[t+1].parentElement.classList.remove("closed"),e=!0)}})}),n&&n.addEventListener("change",t=>{const l=e.querySelectorAll(".quiz__step--4 .field:not(.js-reset-fields) input");t.currentTarget.checked&&l.forEach(e=>{e.value="",e.checked=!1,e.parentElement.classList.remove("active")})})}),l.addEventListener("click",r=>{const s=e.querySelector(".quiz__step.open"),i=e.querySelectorAll(".js-check-nothing"),a=e.querySelectorAll(".quiz__step--3 .field:not(.js-reset-fields) input, .quiz__step--4 .field:not(.js-reset-fields) input");let o=!1;if(c<12&&r.preventDefault(),c<13)if(c>2){t[c-3].querySelectorAll(".field input").forEach(e=>{(e.checked||"text"===e.getAttribute("type")&&""!==e.value||c<3||c>4)&&(o=!0)}),o?(s.classList.remove("open"),s.nextElementSibling.classList.add("open"),c++,n.classList.add("d-none")):n.classList.remove("d-none")}else s.classList.remove("open"),s.nextElementSibling.classList.add("open"),c++,s.nextElementSibling.querySelector(".hidden")&&setTimeout(()=>{s.nextElementSibling.querySelector(".hidden").classList.remove("hidden")},100);switch(c){case 2:l.textContent="Вперед";break;case 3:l.textContent="Больше не знаю";break;case 4:l.textContent="Вперед";break;case 5:a.forEach(e=>{(e.checked||"text"===e.getAttribute("type")&&""!=e.value)&&i.forEach(t=>{t.insertAdjacentHTML("beforebegin",`<label class="field field--checkbox">\n\t\t\t\t\t\t\t\t\t<input class="field__input" type="checkbox" name="${t.closest(".quiz__step").dataset.name}" value="${e.value}" data-value="${e.value}" /><span class="field__label">${e.parentElement.querySelector(".field__input").value}</span><b></b>\n\t\t\t\t\t\t\t\t</label>`),t.querySelector("input").addEventListener("change",e=>{const t=e.currentTarget.closest(".quiz__step").querySelectorAll(".field:not(.js-check-nothing) input");e.currentTarget.checked&&t.forEach(e=>{e.value="",e.checked=!1})}),t.parentElement.querySelectorAll(".field:not(.js-check-nothing) input").forEach(e=>{e.addEventListener("change",e=>{t.querySelector("input").checked=!1})})})});break;case 12:l.setAttribute("type","submit");break;case 13:e.addEventListener("submit",t=>{t.preventDefault();let l='{"form":{';for(let t=3;t<13;t++){const n=e.querySelectorAll(`.quiz__step--${t} .field input`);l+=`"step${t}": {`;let c=[],r=!0;for(let e=0;e<n.length;e++)("checkbox"===n[e].getAttribute("type")&&n[e].checked||"text"===n[e].getAttribute("type")&&""!=n[e].value)&&(-1==c.indexOf(n[e].getAttribute("name"))&&(c.push(n[e].getAttribute("name")),l+=`"${n[e].getAttribute("name")}": [`,r=!1),l+=`"${n[e].value||n[e].dataset.value}",`);l+=r?"":"[]]",l+=12===t?"}":"},"}l+="}}",fetch("path-to-ajax",{method:"POST",body:l}).then(e=>{console.log(e)}).catch(e=>{console.error(e)})}),l.classList.add("d-none"),s.nextElementSibling.querySelector(".hidden")&&setTimeout(()=>{s.nextElementSibling.querySelector(".hidden").classList.remove("hidden")},100),setTimeout(()=>{e.classList.add("d-none")},3e3)}})}});
//# sourceMappingURL=maps/main.min.js.map

document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".quiz");if(e){const t=e.querySelectorAll(".quiz__fields"),l=e.querySelector(".quiz__next"),n=e.querySelector(".quiz__error");let r=1;t.forEach(t=>{const l=t.querySelectorAll(".js-toggle-field .field__label"),n=e.querySelector(".js-reset-fields input"),r=t.querySelectorAll('.field:not(.js-reset-fields) input[type="checkbox"]'),c=t.querySelectorAll('.field:not(.js-reset-fields) input[type="text"]');r.forEach(e=>{e.addEventListener("change",e=>{e.currentTarget.checked&&(n.checked=!1)})}),c.forEach(e=>{e.addEventListener("change",e=>{e.currentTarget.checked&&(n.checked=!1)})}),l.forEach((e,t,l)=>{e.addEventListener("click",e=>{if(e.currentTarget.parentElement.classList.toggle("active"),t>1){let e=!1;e||(l[t+1].parentElement.classList.remove("closed"),e=!0)}})}),n&&n.addEventListener("change",t=>{const l=e.querySelectorAll(".quiz__step--4 .field:not(.js-reset-fields) input");t.currentTarget.checked&&l.forEach(e=>{e.value="",e.checked=!1,e.parentElement.classList.remove("active")})})}),l.addEventListener("click",c=>{const a=e.querySelector(".quiz__step.open"),i=e.querySelectorAll(".js-check-nothing"),s=e.querySelectorAll(".quiz__step--3 .field:not(.js-reset-fields) input, .quiz__step--4 .field:not(.js-reset-fields) input");let o=!1;if(r<12&&c.preventDefault(),r<13)if(r>2){t[r-3].querySelectorAll(".field input").forEach(e=>{(e.checked||"text"===e.getAttribute("type")&&""!==e.value||r<3||r>4)&&(o=!0)}),o?(a.classList.remove("open"),a.nextElementSibling.classList.add("open"),r++,n.classList.add("d-none")):n.classList.remove("d-none")}else a.classList.remove("open"),a.nextElementSibling.classList.add("open"),r++,a.nextElementSibling.querySelector(".hidden")&&setTimeout(()=>{a.nextElementSibling.querySelector(".hidden").classList.remove("hidden")},100);switch(r){case 2:l.textContent="Вперед";break;case 3:l.textContent="Больше не знаю";break;case 4:l.textContent="Вперед";break;case 5:s.forEach(e=>{(e.checked||"text"===e.getAttribute("type")&&""!=e.value)&&i.forEach(t=>{t.insertAdjacentHTML("beforebegin",`<label class="field field--checkbox">\n\t\t\t\t\t\t\t\t\t<input class="field__input" type="checkbox" name="${t.closest(".quiz__step").dataset.name}" value="${e.value}" data-value="${e.value}" /><span class="field__label">${"checkbox"===e.type?e.parentElement.querySelector(".field__label").textContent:e.value}</span><b></b>\n\t\t\t\t\t\t\t\t</label>`),t.querySelector("input").addEventListener("change",e=>{const t=e.currentTarget.closest(".quiz__step").querySelectorAll(".field:not(.js-check-nothing) input");e.currentTarget.checked&&t.forEach(e=>{e.value="",e.checked=!1})}),t.parentElement.querySelectorAll(".field:not(.js-check-nothing) input").forEach(e=>{e.addEventListener("change",e=>{t.querySelector("input").checked=!1})})})});break;case 12:l.setAttribute("type","submit");break;case 13:e.addEventListener("submit",t=>{t.preventDefault();let l=[],n='{"form":{';for(let t=3;t<13;t++){const r=e.querySelectorAll(`.quiz__step--${t} .field input`);r.forEach(e=>{console.log("name "+e.getAttribute("name")),console.log("value "+e.value)}),n+=`"step${t}": {`,l=[],arrIndex=[],arrMemory=[];for(let e=0;e<r.length;e++)""!=r[e].value?(l.push('"'+r[e].value+'"'),arrIndex.push(r[e].getAttribute("name")),console.log("Filled"+r[e].value)):console.log("Empty"+r[e].value);let c=[],a=0;for(let e=0;e<r.length;e++)if("checkbox"===r[e].getAttribute("type")&&r[e].checked||"text"===r[e].getAttribute("type")&&""!=r[e].value){for(;arrIndex.length>0;){let t=arrIndex.indexOf(r[e].getAttribute("name"));-1!=t&&(arrMemory.push(l[t]),delete arrIndex[t],delete l[t])}-1==c.indexOf(r[e].getAttribute("name"))&&(c.push(r[e].getAttribute("name")),n+=r[e].getAttribute("name")+": ",a=1),e!=r[r.length-1]&&1!=a||(arrMemory=[],n+="["+arrMemory.join(",")+"]",1==a&&e!=r[r.length-1]&&(n+=","),l=[],a=0),r[e].getAttribute("name"),r[e].getAttribute("name").startsWith("company-")&&r[e+1].getAttribute("name").startsWith("company-")}n+=12===t?"}":"},"}n+="}}",console.log(n),$.ajax({type:"POST",url:window.location,data:JSON.parse(n),complete:function(e,t){200===e.status&&e.responseText}})}),l.classList.add("d-none"),a.nextElementSibling.querySelector(".hidden")&&setTimeout(()=>{a.nextElementSibling.querySelector(".hidden").classList.remove("hidden")},100)}})}});
//# sourceMappingURL=maps/main.min.js.map

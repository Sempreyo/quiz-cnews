document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".quiz");if(e){const t=e.querySelectorAll(".quiz__fields"),n=e.querySelector(".quiz__next"),l=e.querySelector(".quiz__error");let r=1;t.forEach(t=>{const n=t.querySelectorAll(".js-toggle-field .field__label"),l=e.querySelector(".js-reset-fields input");t.querySelectorAll('.field:not(.js-reset-fields) input[type="checkbox"]').forEach(e=>{e.addEventListener("change",e=>{e.currentTarget.checked&&(l.checked=!1)})}),n.forEach((e,t,n)=>{e.addEventListener("click",e=>{if(e.currentTarget.parentElement.classList.toggle("active"),e.currentTarget.parentElement.classList.contains("active")&&(l.checked=!1),t>1){let e=!1;!e&&n[t+1]&&(n[t+1].parentElement.classList.remove("closed"),e=!0)}})}),l&&l.addEventListener("change",t=>{const n=e.querySelectorAll(".quiz__step--3 .field:not(.js-reset-fields) input");t.currentTarget.checked&&n.forEach(e=>{"text"===e.getAttribute("type")&&(e.value=""),e.checked=!1,e.parentElement.classList.remove("active")})})}),n.addEventListener("click",c=>{const i=e.querySelector(".quiz__step.open"),s=e.querySelectorAll(".js-check-nothing"),a=(e.querySelectorAll(".quiz__step--2 .field:not(.js-reset-fields) input, .quiz__step--3 .field:not(.js-reset-fields) input"),e.querySelectorAll(".quiz__step--3 .field:not(.js-reset-fields) input"));let o=!1;if(r<11&&c.preventDefault(),r<12)if(r>1){t[r-2].querySelectorAll(".field input").forEach(e=>{(e.checked||"text"===e.getAttribute("type")&&""!==e.value||r<2||r>3)&&(o=!0)}),o?(i.classList.remove("open"),i.nextElementSibling.classList.add("open"),r++,l.classList.add("d-none")):l.classList.remove("d-none")}else i.classList.remove("open"),i.nextElementSibling.classList.add("open"),r++,i.nextElementSibling.querySelector(".hidden")&&setTimeout(()=>{i.nextElementSibling.querySelector(".hidden").classList.remove("hidden")},100);switch(r){case 1:n.textContent="Вперед";break;case 2:n.textContent="Больше не знаю";break;case 3:n.textContent="Вперед";break;case 4:a.forEach(e=>{(e.checked||"text"===e.getAttribute("type")&&""!=e.value)&&s.forEach(t=>{t.insertAdjacentHTML("beforebegin",`<label class="field field--checkbox">\n\t\t\t\t\t\t\t\t\t<input class="field__input" type="checkbox" name="${t.closest(".quiz__step").dataset.name}" value="${e.value}" data-value="${e.value}" /><span class="field__label">${"checkbox"===e.type?e.parentElement.querySelector(".field__label").textContent:e.value}</span><b></b>\n\t\t\t\t\t\t\t\t</label>`),t.querySelector("input").addEventListener("change",e=>{const t=e.currentTarget.closest(".quiz__step").querySelectorAll(".field:not(.js-check-nothing) input");e.currentTarget.checked&&t.forEach(e=>{e.checked=!1})}),t.parentElement.querySelectorAll(".field:not(.js-check-nothing) input").forEach(e=>{e.addEventListener("change",e=>{t.querySelector("input").checked=!1})})})});break;case 11:n.setAttribute("type","submit");break;case 12:e.addEventListener("submit",t=>{t.preventDefault();let n='{"form":{';for(let t=2;t<12;t++){const l=e.querySelectorAll(`.quiz__step--${t} .field input`);let r=[],c=[],i=0;l.forEach(e=>{("checkbox"===e.getAttribute("type")&&e.checked||"text"===e.getAttribute("type")&&""!==e.value)&&r.push(e)}),n+=`"step${t}": {`,r.forEach(e=>{-1==c.indexOf(e.getAttribute("name"))&&(c.push(e.getAttribute("name")),i++)}),c=[],r.forEach((e,t,l)=>{if(-1==c.indexOf(e.getAttribute("name"))){let s=[];c.push(e.getAttribute("name")),n+=`"${e.getAttribute("name")}": [`,l.forEach(t=>{t.getAttribute("name")==e.getAttribute("name")&&s.push(`"${t.value}"`)}),n+=""+s.join(","),n+="]"+(i>1&&t!==r.length-1?",":"")}}),n+=11===t?"}":"},"}n+="}}",$.ajax({type:"POST",url:window.location,data:JSON.parse(n),complete:function(e,t){200===e.status&&e.responseText}})}),n.classList.add("d-none"),i.nextElementSibling.querySelector(".hidden")&&setTimeout(()=>{i.nextElementSibling.querySelector(".hidden").classList.remove("hidden")},100)}})}});
//# sourceMappingURL=maps/main.min.js.map
